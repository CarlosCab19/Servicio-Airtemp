
<nav class="navbar">
  <button class="btnNav" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions">
    <span class="icon">
        <svg viewBox="0 0 175 80" width="40" height="40">
            <rect width="80" height="15" fill="#f0f0f0" rx="10"></rect>
            <rect y="30" width="80" height="15" fill="#f0f0f0" rx="10"></rect>
            <rect y="60" width="80" height="15" fill="#f0f0f0" rx="10"></rect>
        </svg>
    </span>
    <span class="text">MENU</span>
  </button>
  <section class="form">
    <label for="search">
      <input class="input" type="text" required="" placeholder="Buscar" id="search" [(ngModel)]="filtroBusqueda">
        <div class="fancy-bg"></div>
        <div class="search">
            <svg viewBox="0 0 24 24" aria-hidden="true" class="r-14j79pv r-4qtqp9 r-yyyyoo r-1xvli5t r-dnmrzs r-4wgw6l r-f727ji r-bnwqim r-1plcrui r-lrvibr">
                <g>
                    <path d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"></path>
                </g>
            </svg>
        </div>
        <button class="close-btn" type="reset">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
        </button>
    </label>
  </section>
</nav>
<body>
  <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions" aria-labelledby="offcanvasWithBothOptionsLabel">
    <div class="offcanvas-header">
      <img src="assets\img-logo\Letras_Airtemp.png" class="logo">
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <button id="btn-menu" data-bs-dismiss="offcanvas" routerLink="/soporte/:id">
          <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM64 80c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16zm0 64c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16zm128 72c8.8 0 16 7.2 16 16v17.3c8.5 1.2 16.7 3.1 24.1 5.1c8.5 2.3 13.6 11 11.3 19.6s-11 13.6-19.6 11.3c-11.1-3-22-5.2-32.1-5.3c-8.4-.1-17.4 1.8-23.6 5.5c-5.7 3.4-8.1 7.3-8.1 12.8c0 3.7 1.3 6.5 7.3 10.1c6.9 4.1 16.6 7.1 29.2 10.9l.5 .1 0 0 0 0c11.3 3.4 25.3 7.6 36.3 14.6c12.1 7.6 22.4 19.7 22.7 38.2c.3 19.3-9.6 33.3-22.9 41.6c-7.7 4.8-16.4 7.6-25.1 9.1V440c0 8.8-7.2 16-16 16s-16-7.2-16-16V422.2c-11.2-2.1-21.7-5.7-30.9-8.9l0 0c-2.1-.7-4.2-1.4-6.2-2.1c-8.4-2.8-12.9-11.9-10.1-20.2s11.9-12.9 20.2-10.1c2.5 .8 4.8 1.6 7.1 2.4l0 0 0 0 0 0c13.6 4.6 24.6 8.4 36.3 8.7c9.1 .3 17.9-1.7 23.7-5.3c5.1-3.2 7.9-7.3 7.8-14c-.1-4.6-1.8-7.8-7.7-11.6c-6.8-4.3-16.5-7.4-29-11.2l-1.6-.5 0 0c-11-3.3-24.3-7.3-34.8-13.7c-12-7.2-22.6-18.9-22.7-37.3c-.1-19.4 10.8-32.8 23.8-40.5c7.5-4.4 15.8-7.2 24.1-8.7V232c0-8.8 7.2-16 16-16z"/></svg>
            GESTION DE EMPLEADOS
        </button>
        <button id="btn-menu" data-bs-dismiss="offcanvas" routerLink="/solicitudes">
          <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M416 176c0 97.2-93.1 176-208 176c-38.2 0-73.9-8.7-104.7-23.9c-7.5 4-16 7.9-25.2 11.4C59.8 346.4 37.8 352 16 352c-6.9 0-13.1-4.5-15.2-11.1s.2-13.8 5.8-17.9l0 0 0 0 .2-.2c.2-.2 .6-.4 1.1-.8c1-.8 2.5-2 4.3-3.7c3.6-3.3 8.5-8.1 13.3-14.3c5.5-7 10.7-15.4 14.2-24.7C14.7 250.3 0 214.6 0 176C0 78.8 93.1 0 208 0S416 78.8 416 176zM231.5 383C348.9 372.9 448 288.3 448 176c0-5.2-.2-10.4-.6-15.5C555.1 167.1 640 243.2 640 336c0 38.6-14.7 74.3-39.6 103.4c3.5 9.4 8.7 17.7 14.2 24.7c4.8 6.2 9.7 11 13.3 14.3c1.8 1.6 3.3 2.9 4.3 3.7c.5 .4 .9 .7 1.1 .8l.2 .2 0 0 0 0c5.6 4.1 7.9 11.3 5.8 17.9c-2.1 6.6-8.3 11.1-15.2 11.1c-21.8 0-43.8-5.6-62.1-12.5c-9.2-3.5-17.8-7.4-25.2-11.4C505.9 503.3 470.2 512 432 512c-95.6 0-176.2-54.6-200.5-129zM228 72c0-11-9-20-20-20s-20 9-20 20V86c-7.6 1.7-15.2 4.4-22.2 8.5c-13.9 8.3-25.9 22.8-25.8 43.9c.1 20.3 12 33.1 24.7 40.7c11 6.6 24.7 10.8 35.6 14l1.7 .5c12.6 3.8 21.8 6.8 28 10.7c5.1 3.2 5.8 5.4 5.9 8.2c.1 5-1.8 8-5.9 10.5c-5 3.1-12.9 5-21.4 4.7c-11.1-.4-21.5-3.9-35.1-8.5c-2.3-.8-4.7-1.6-7.2-2.4c-10.5-3.5-21.8 2.2-25.3 12.6s2.2 21.8 12.6 25.3c1.9 .6 4 1.3 6.1 2.1l0 0 0 0c8.3 2.9 17.9 6.2 28.2 8.4V280c0 11 9 20 20 20s20-9 20-20V266.2c8-1.7 16-4.5 23.2-9c14.3-8.9 25.1-24.1 24.8-45c-.3-20.3-11.7-33.4-24.6-41.6c-11.5-7.2-25.9-11.6-37.1-15l-.7-.2c-12.8-3.9-21.9-6.7-28.3-10.5c-5.2-3.1-5.3-4.9-5.3-6.7c0-3.7 1.4-6.5 6.2-9.3c5.4-3.2 13.6-5.1 21.5-5c9.6 .1 20.2 2.2 31.2 5.2c10.7 2.8 21.6-3.5 24.5-14.2s-3.5-21.6-14.2-24.5c-6.5-1.7-13.7-3.4-21.1-4.7V72z"/></svg>
            SOLICITUDES
        </button>
        <button id="btn-menu" routerLink="/inicio">
          <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M208 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zM123.7 200.5c1-.4 1.9-.8 2.9-1.2l-16.9 63.5c-5.6 21.1-.1 43.6 14.7 59.7l70.7 77.1 22 88.1c4.3 17.1 21.7 27.6 38.8 23.3s27.6-21.7 23.3-38.8l-23-92.1c-1.9-7.8-5.8-14.9-11.2-20.8l-49.5-54 19.3-65.5 9.6 23c4.4 10.6 12.5 19.3 22.8 24.5l26.7 13.3c15.8 7.9 35 1.5 42.9-14.3s1.5-35-14.3-42.9L281 232.7l-15.3-36.8C248.5 154.8 208.3 128 163.7 128c-22.8 0-45.3 4.8-66.1 14l-8 3.5c-32.9 14.6-58.1 42.4-69.4 76.5l-2.6 7.8c-5.6 16.8 3.5 34.9 20.2 40.5s34.9-3.5 40.5-20.2l2.6-7.8c5.7-17.1 18.3-30.9 34.7-38.2l8-3.5zm-30 135.1L68.7 398 9.4 457.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L116.3 441c4.6-4.6 8.2-10.1 10.6-16.1l14.5-36.2-40.7-44.4c-2.5-2.7-4.8-5.6-7-8.6zM550.6 153.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L530.7 224H384c-17.7 0-32 14.3-32 32s14.3 32 32 32H530.7l-25.4 25.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l80-80c12.5-12.5 12.5-32.8 0-45.3l-80-80z"/></svg>
          Salir
        </button>
    </div>
  </div>
  <h2 class="text-center">SOLICITUDES</h2>
  <section class="table-container">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Folio</th>
          <th scope="col">Solicitante</th>
          <th scope="col">Tipo</th>
          <th scope="col">Cliente</th>
          <th scope="col">Analista</th>
          <th scope="col">Director</th>
          <th scope="col">Estatus</th>
          <th scope="col">Acciones</th>
          <th scope="col">Información</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let solicitud of solicitudes of filtrarSolicitudes()">
          <td>{{solicitud.id}}</td>
          <td>{{solicitud.solicitante}}</td>
          <td>{{solicitud.tipo}}</td>
          <td>{{solicitud.NomCliente}}</td>
          <td>{{solicitud.id_analista}}</td>
          <td>{{solicitud.id_director}}</td>
          <td [ngStyle]="{'color': solicitud.estatus === 'Aprobado' ? 'blue' : (solicitud.estatus === 'Cotizado' ? 'orange' : 'green'), 'font-weight': solicitud.estatus === 'Aprobado' || solicitud.estatus === 'Cotizado' || solicitud.estatus === 'Rechazado' ? 'bold' : 'bold'}">{{solicitud.estatus}}</td>
          <td><button (click)="verEditar(solicitud.id)" class="btn" id="editar" data-bs-toggle="modal" data-bs-target="#exampleModal">Editar</button></td>
          <td><button (click)="verInformacion(solicitud.id)" type="button" class="btn" data-bs-toggle="modal" data-bs-target="#exampleModal2">Ver</button></td>
        </tr>
      </tbody>
    </table>
  </section>
  <section>
    <!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel fw-bold">SOLICITUD</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="form">
          <section class="row">
            <div class="col">
              <label for="formGroupExampleInput" class="form-label fw-bold">Folio</label>
              <input type="text" name="folio" class="form-control" value="{{idSolicitud}}" disabled>
            </div>
            <div class="col">
              <label for="formGroupExampleInput2" class="form-label fw-bold">Tipo</label>
              <input type="text" class="form-control" value="{{tipo}}" disabled>
            </div>
            <div class="col" *ngIf="solicitud">
              <label for="estatus" class="form-label fw-bold">Estatus</label>
              <select class="form-select" aria-label="Default select example" [(ngModel)]="solicitud.estatus" formControlName="estatus" id="estatus" (change)="onEstatusChanged(solicitud.id)">
                <option value="Editando">Editando</option>
                <option value="Nueva">Nueva</option>
                <option value="Cotizado">Cotizado</option>
                <option value="Aprobado">Aprobado</option>
                <option value="Vencido">Vencido</option>
              </select>

            </div>
          </section>
          <section class="row">
            <div class="col">
              <label for="formGroupExampleInput2" class="form-label fw-bold">Solicitante</label>
              <input type="text" name="solicitante" class="form-control" value="{{id_solicitante}}" disabled>
            </div>
            <div class="col">
              <label for="formGroupExampleInput" class="form-label fw-bold">Analista</label>
              <input type="text" name="analista" class="form-control" value="{{id_analista}}" disabled>
            </div>
            <div class="col">
              <label for="formGroupExampleInput2" class="form-label fw-bold">Director</label>
              <input type="text" name="director" class="form-control" value="{{id_director}}" disabled>
            </div>
          </section>
          <br>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
  </section>
  <!--Modal para ver toda la informacion de la solicitud-->
  <section>
    <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel2" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">INFORMACION DE LA SOLICITUD</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <!--Contenido del modal-->
            <div class="accordion accordion-flush" id="accordionFlushExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"><path fill="#000000" d="m17.371 19.827l2.84-2.796l-.626-.627l-2.214 2.183l-.956-.975l-.627.632l1.583 1.583ZM6.77 8.73h10.462v-1H6.769v1ZM18 22.115q-1.671 0-2.836-1.164T14 18.115q0-1.67 1.164-2.835T18 14.115q1.671 0 2.836 1.165T22 18.115q0 1.672-1.164 2.836Q19.67 22.115 18 22.115ZM4 20.77V5.615q0-.67.472-1.143Q4.944 4 5.615 4h12.77q.67 0 1.143.472q.472.472.472 1.143v5.945q-.244-.09-.485-.154q-.24-.064-.515-.1v-5.69q0-.231-.192-.424Q18.615 5 18.385 5H5.615q-.23 0-.423.192Q5 5.385 5 5.615V19.05h6.344q.068.41.176.802q.109.392.303.748l-.035.035l-1.134-.827l-1.346.961l-1.346-.961l-1.347.961l-1.346-.961L4 20.769Zm2.77-4.5h4.709q.056-.275.138-.515q.083-.24.193-.485H6.77v1Zm0-3.769h7.31q.49-.387 1.05-.645q.56-.259 1.197-.355H6.769v1ZM5 19.05V5v14.05Z"/></svg>
                    SOLICITUD
                  </button>
                </h2>
                <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body p-3 mb-2 bg-body-secondary">
                    <!--Contendido de la solicitud (Solicitante)-->
                    <section class="row">
                      <div class="col">
                        <label for="formGroupExampleInput" class="form-label fw-bold">Folio</label>
                        <input type="text" name="folio" class="form-control border-primary" value="{{idSolicitud}}" disabled>
                      </div>
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Tipo</label>
                        <input type="text" class="form-control border-primary" value="{{tipo}}" disabled>
                      </div>
                      <div class="col" *ngIf="solicitud">
                        <label for="estatus" class="form-label fw-bold">Estatus</label>
                        <input type="text" class="form-control border-primary" value="{{estatus}}" disabled>
                      </div>
                    </section>
                    <section class="row">
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Cliente</label>
                        <input type="text" class="form-control border-primary" value="{{cliente}}" disabled>
                      </div>
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Codigo proveedor</label>
                        <input type="text" class="form-control border-primary" value="{{codigoProv}}" disabled>
                      </div>
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Num. parte</label>
                        <input type="text" class="form-control border-primary" value="{{numParte}}" disabled>
                      </div>
                    </section>
                    <section class="row">
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Solicitante</label>
                        <input type="text" class="form-control border-primary" value="{{id_solicitante}}" disabled>
                      </div>
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Analista</label>
                        <input type="text" class="form-control border-primary" value="{{id_analista}}" disabled>
                      </div>
                      <div class="col">
                        <label for="formGroupExampleInput2" class="form-label fw-bold">Director</label>
                        <input type="text" class="form-control border-primary" value="{{id_director}}" disabled>
                      </div>
                    </section>
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"><path fill="#000000" d="M11.5 17.5h1v-1H14q.213 0 .357-.143q.143-.144.143-.357v-3q0-.213-.143-.357q-.144-.143-.357-.143h-3.5v-2h4v-1h-2v-1h-1v1H10q-.213 0-.357.143Q9.5 9.787 9.5 10v3q0 .213.143.357q.144.143.357.143h3.5v2h-4v1h2v1ZM6.615 21q-.69 0-1.152-.462Q5 20.075 5 19.385V4.615q0-.69.463-1.152Q5.925 3 6.615 3h6.962L19 8.423v10.962q0 .69-.462 1.152q-.463.463-1.153.463H6.615Zm0-1h10.77q.23 0 .423-.192q.192-.193.192-.423V8.85L13.15 4H6.615q-.23 0-.423.192Q6 4.385 6 4.615v14.77q0 .23.192.423q.193.192.423.192ZM6 20V4v16Z"/></svg>
                    COTIZACION
                  </button>
                </h2>
                <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                  <div class="accordion-body p-3 mb-2 bg-body-secondary">
                    <!--Contenido de la solicitud (Analista)-->
                  <div class="accordion accordion-flush" id="accordionFlushExample">
                    <div class="accordion-item4" *ngFor="let material of materiales">
                      <h2 class="accordion-header4">
                        <button (click)="cotizacion(material.id)" class="accordion-button collapsed" type="button"
                          [attr.data-bs-toggle]="estaAbierto(material.id) ? 'collapse' : ''"
                          [attr.data-bs-target]="'#flush-collapseFour_' + material.id"
                          [attr.aria-controls]="'flush-collapseFour_' + material.id"
                          [attr.aria-expanded]="estaAbierto(material.id) ? 'true' : 'false'">
                          {{material.descripcion}}
                        </button>
                      </h2>
                      <!--<div [id]="'flush-collapseFour_' + material.id" class="accordion-collapse2 collapse" data-bs-parent="#accordionFlushExample4" style="padding: 0; margin: 0;">-->
                      <div [id]="'flush-collapseFour_' + material.id" class="accordion-collapse2 collapse" [class.show]="estaAbierto(material.id)" data-bs-parent="#accordionFlushExample4" style="padding: 0; margin: 0;">
                        <div class="accordion-body4" style="padding: 0; margin: 0;">
                          <!--Tabla de las cotizaciones-->
                          <section class="table-container">
                            <table class="table table-hover table-sm" style="width: 100%; margin: 0;">
                              <thead>
                                <tr>
                                  <th scope="col">Estatus</th>
                                  <th scope="col">Fabricación</th>
                                  <th scope="col">LME</th>
                                  <th scope="col">Premium</th>
                                  <th scope="col">Icoterm</th>
                                  <th scope="col">Adcional</th>
                                  <th scope="col">Total</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let cotizaciones of cotizaciones">
                                  <td  class="fw-bold" [ngStyle]="{'color': cotizaciones.estatus === 'Autorizado' ? 'blue' : (cotizaciones.estatus === 'Rechazado' ? 'red' : 'black')}">{{cotizaciones.estatus}}</td>
                                  <td>{{cotizaciones.fabricacion | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                  <td>{{cotizaciones.lme | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                  <td>{{cotizaciones.premium | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                  <td>{{cotizaciones.icoterm | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                  <td>{{cotizaciones.adicional | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                  <td>{{cotizaciones.total | currency:monedaSimbolos[cotizaciones.moneda]:'symbol'}}</td>
                                </tr>
                              </tbody>
                            </table>
                          </section>
                          <!----------->
                        </div>
                      </div>
                    </div>
                  </div>
                    <!---->
                  </div>
                </div>
              </div>
            </div>
            <!---->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </section>
</body>
